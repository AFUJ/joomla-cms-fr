Joomla=window.Joomla||{},((e,t)=>{e.submitbuttonUpload=()=>{const l=t.getElementById("uploadForm");""===l.install_package.value?alert(e.JText._("COM_INSTALLER_MSG_INSTALL_PLEASE_SELECT_A_PACKAGE"),!0):l.install_package.files[0].size>l.max_upload_size.value?alert(e.JText._("COM_INSTALLER_MSG_WARNINGS_UPLOADFILETOOBIG"),!0):l.submit()},e.installpackageChange=()=>{const l=t.getElementById("uploadForm"),a=l.install_package.files[0].size,i=1*a/1024/1024,o=t.getElementById("file_size"),s=t.getElementById("max_upload_size_warn");""===l.install_package.value?(o.classList.add("hidden"),s.classList.add("hidden")):a&&(o.classList.remove("hidden"),o.innerHTML=e.JText._("JGLOBAL_SELECTED_UPLOAD_FILE_SIZE").replace("%s",`${i.toFixed(2)} MB`),a>l.max_upload_size.value?s.classList.remove("hidden"):s.classList.add("hidden"))},t.addEventListener("DOMContentLoaded",(()=>{const e=t.getElementById("uploadButton"),l=t.getElementById("downloadMessage");e&&e.addEventListener("click",(()=>{l&&l.classList.remove("hidden")}))}))})(Joomla,document),((e,t)=>{const l={config:{serverUrl:"index.php?option=com_joomlaupdate&task=update.fetchextensioncompatibility",selector:".extension-check"},STATE:{INCOMPATIBLE:0,COMPATIBLE:1,MISSING_COMPATIBILITY_TAG:2,SERVER_ERROR:3},run:()=>{[].slice.call(t.querySelectorAll(".settingstoggle")).forEach((t=>{t.style.float="right",t.style.cursor="pointer",t.addEventListener("click",(l=>{const a=t.closest("fieldset");"closed"===l.target.dataset.state?(l.target.dataset.state="open",l.target.innerHTML=e.getOptions("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSIONS_SHOW_LESS_COMPATIBILITY_INFORMATION"),a.querySelectorAll(".settingsInfo").forEach((e=>{e.classList.remove("hidden")}))):(l.target.dataset.state="closed",l.target.innerHTML=e.getOptions("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSIONS_SHOW_MORE_COMPATIBILITY_INFORMATION"),a.querySelectorAll(".settingsInfo").forEach((e=>{e.classList.add("hidden")})))}))})),l.nonCoreCriticalPlugins=e.getOptions("nonCoreCriticalPlugins",[]),0===l.nonCoreCriticalPlugins.length&&null!==t.getElementById("updateView")&&(t.getElementById("preupdateCheckWarning").style.display="none",t.getElementById("preupdateconfirmation").style.display="none",t.getElementById("preupdatecheckbox").style.display="none",t.getElementById("preupdatecheckheadings").style.display="none",t.getElementById("preupdatecheckbox").checked=!0,t.getElementById("noncoreplugins").checked=!0,[].slice.call(t.querySelectorAll("button.submitupdate")).forEach((e=>{e.classList.remove("disabled"),e.removeAttribute("disabled")})));const a=t.querySelectorAll(l.config.selector);if(0===a.length)return;const i=()=>{const l=t.getElementById("preupdatecheckbox").checked,a=t.getElementById("noncoreplugins").checked;l&&a?window.confirm(e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_POTENTIALLY_DANGEROUS_PLUGIN_CONFIRM_MESSAGE"))?[].slice.call(t.querySelectorAll("button.submitupdate")).forEach((e=>{e.classList.remove("disabled"),e.removeAttribute("disabled")})):(t.getElementById("preupdatecheckbox").checked=!0,t.getElementById("noncoreplugins").checked=!0):[].slice.call(t.querySelectorAll("button.submitupdate")).forEach((e=>{e.classList.remove("disabled"),e.removeAttribute("disabled")}))};null!==t.getElementById("updateView")&&(t.getElementById("preupdatecheckbox").addEventListener("change",i),t.getElementById("noncoreplugins").addEventListener("change",i));const o=t.getElementById("joomlaupdate-wrapper");l.joomlaTargetVersion=o.getAttribute("data-joomla-target-version"),l.joomlaCurrentVersion=o.getAttribute("data-joomla-current-version"),[].slice.call(t.querySelectorAll(".compatibilitytypes img")).forEach((e=>{e.style.height="20px"})),[].slice.call(t.querySelectorAll(".compatibilitytypes")).forEach((e=>{e.style.display="none",e.style.marginLeft=0}));const s=t.getElementById("compatibilitytype0");s&&(s.style.display="block"),[].slice.call(t.querySelectorAll(".compatibilitytoggle")).forEach((t=>{t.style.float="right",t.style.cursor="pointer",t.addEventListener("click",(()=>{const a=t.closest("fieldset.compatibilitytypes");"closed"===t.dataset.state?(t.dataset.state="open",t.innerHTML=e.getOptions("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSIONS_SHOW_LESS_COMPATIBILITY_INFORMATION"),[].slice.call(a.querySelectorAll(".exname")).forEach((e=>{e.classList.remove("col-md-8"),e.classList.add("col-md-4")})),[].slice.call(a.querySelectorAll(".extype")).forEach((e=>{e.classList.remove("col-md-4"),e.classList.add("col-md-1")})),[].slice.call(a.querySelectorAll(".upcomp")).forEach((e=>{e.classList.remove("hidden"),e.classList.add("col-md-3")})),[].slice.call(a.querySelectorAll(".currcomp")).forEach((e=>{e.classList.remove("hidden"),e.classList.add("col-md-3")})),[].slice.call(a.querySelectorAll(".instver")).forEach((e=>{e.classList.remove("hidden"),e.classList.add("col-md-1")})),l.showyellowwarning&&a.querySelector("#updateyellowwarning")&&a.querySelector("#updateyellowwarning").classList.remove("hidden"),l.showorangewarning&&a.querySelector("#updateorangewarning")&&a.querySelector("#updateorangewarning").classList.remove("hidden")):(t.dataset.state="closed",t.innerHTML=e.getOptions("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSIONS_SHOW_MORE_COMPATIBILITY_INFORMATION"),[].slice.call(a.querySelectorAll(".exname")).forEach((e=>{e.classList.add("col-md-8"),e.classList.remove("col-md-4")})),[].slice.call(a.querySelectorAll(".extype")).forEach((e=>{e.classList.add("col-md-4"),e.classList.remove("col-md-1")})),[].slice.call(a.querySelectorAll(".upcomp")).forEach((e=>{e.classList.add("hidden"),e.classList.remove("col-md-3")})),[].slice.call(a.querySelectorAll(".currcomp")).forEach((e=>{e.classList.add("hidden"),e.classList.remove("col-md-3")})),[].slice.call(a.querySelectorAll(".instver")).forEach((e=>{e.classList.add("hidden"),e.classList.remove("col-md-1")})),l.showyellowwarning&&a.querySelector("#updateyellowwarning")&&a.querySelector("#updateyellowwarning").classList.add("hidden"),l.showorangewarning&&a.querySelector("#updateorangewarning")&&a.querySelector("#updateorangewarning").classList.add("hidden"))}))})),[].slice.call(a).forEach((e=>{l.checkCompatibility(e,l.setResultView)}))},checkCompatibility:(t,a)=>{const i={element:t,compatibleVersion:0,serverError:1};e.request({url:`${l.config.serverUrl}&joomla-target-version=${encodeURIComponent(l.joomlaTargetVersion)}joomla-current-version=${l.joomlaCurrentVersion}extension-version=${t.getAttribute("data-extension-current-version")}&extension-id=${encodeURIComponent(t.getAttribute("data-extension-id"))}`,onSuccess(e){const t=JSON.parse(e);i.serverError=0,i.compatibilityData=t.data,a(i)},onError(){a(i)}})},setResultView:a=>{let i="";if(a.serverError)i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_SERVER_ERROR"),a.compatibilityData={resultGroup:4};else switch(a.compatibilityData.upgradeCompatibilityStatus.state){case l.STATE.COMPATIBLE:a.compatibilityData.upgradeWarning?(i=`<span class="label label-warning">${a.compatibilityData.upgradeCompatibilityStatus.compatibleVersion}</span>`,l.showyellowwarning=!0):i=!1===a.compatibilityData.upgradeCompatibilityStatus.compatibleVersion?e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_NO_COMPATIBILITY_INFORMATION"):a.compatibilityData.upgradeCompatibilityStatus.compatibleVersion;break;case l.STATE.INCOMPATIBLE:case l.STATE.MISSING_COMPATIBILITY_TAG:i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_NO_COMPATIBILITY_INFORMATION"),l.showorangewarning=!0;break;default:i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_WARNING_UNKNOWN")}if(a.element.innerHTML=i,i="",a.serverError)i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_SERVER_ERROR");else switch(a.compatibilityData.currentCompatibilityStatus.state){case l.STATE.COMPATIBLE:i=!1===a.compatibilityData.currentCompatibilityStatus.compatibleVersion?e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_NO_COMPATIBILITY_INFORMATION"):a.compatibilityData.currentCompatibilityStatus.compatibleVersion;break;case l.STATE.INCOMPATIBLE:case l.STATE.MISSING_COMPATIBILITY_TAG:i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_NO_COMPATIBILITY_INFORMATION");break;default:i=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_EXTENSION_WARNING_UNKNOWN")}const o=a.element.getAttribute("data-extension-id");t.getElementById(`available-version-${o}`).innerText=i;const s=t.querySelector(`#compatibilitytype${a.compatibilityData.resultGroup} tbody`);s&&s.appendChild(a.element.closest("tr")),t.getElementById(`compatibilitytype${a.compatibilityData.resultGroup}`).style.display="block",t.getElementById("compatibilitytype0").style.display="block",3===a.compatibilityData.resultGroup&&l.nonCoreCriticalPlugins.forEach(((e,a)=>{e.package_id.toString()!==o&&e.extension_id.toString()!==o||(t.getElementById(`#plg_${e.extension_id}`).remove(),l.nonCoreCriticalPlugins.splice(a,1))}));const n=t.getElementById("preupdatecheckheadings");if(n&&0===n.querySelectorAll("table td").length&&(n.style.display="none"),!t.querySelector("#compatibilitytype0 tbody td")){if(t.getElementById("compatibilitytype0").style.display="none",l.nonCoreCriticalPlugins.forEach((l=>{let a=t.querySelector(`td[data-extension-id="${l.extension_id}"]`);if(a||(a=t.querySelector(`td[data-extension-id="${l.package_id}"]`)),a){const t=a.closest("tr");t.classList.add("error");const l=t.querySelector("td:first-child");l.innerHTML=`${l.innerHTML}\n              <span class="label label-warning " >\n              <span class="icon-warning"></span>\n              ${e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_POTENTIALLY_DANGEROUS_PLUGIN")}\n              </span>\n\n              <span class="label label-important hasPopover"\n              title="${e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_POTENTIALLY_DANGEROUS_PLUGIN")} "\n              data-bs-content="${e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_POTENTIALLY_DANGEROUS_PLUGIN_DESC")} "\n              >\n              <span class="icon-help"></span>\n              ${e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_HELP")}\n              </span>`;const i=l.querySelector(".hasPopover");i&&(i.style.cursor="pointer",new bootstrap.Popover(i,{placement:"top",html:!0,trigger:"focus click"}))}})),null===t.getElementById("updateView"))return;0===l.nonCoreCriticalPlugins.length?(t.getElementById("preupdateCheckWarning").style.display="none",t.getElementById("preupdateconfirmation").style.display="none",t.getElementById("preupdatecheckbox").style.display="none",t.getElementById("preupdatecheckheadings").style.display="none",t.getElementById("preupdatecheckbox").checked=!0,t.getElementById("noncoreplugins").checked=!0,[].slice.call(t.querySelectorAll("button.submitupdate")).forEach((e=>{e.classList.remove("disabled"),e.removeAttribute("disabled")}))):(t.getElementById("preupdateCheckWarning").classList.add("hidden"),t.getElementById("preupdateCheckCompleteProblems").classList.remove("hidden"),[].slice.call(t.querySelectorAll("#preupdateconfirmation .preupdateconfirmation_label h3")).forEach((t=>{t.innerText=e.JText._("COM_JOOMLAUPDATE_VIEW_DEFAULT_POTENTIALLY_DANGEROUS_PLUGIN_LIST")})),[].slice.call(t.querySelectorAll("#preupdateconfirmation .preupdateconfirmation_label")).forEach((e=>{e.classList.add("label-important"),e.classList.remove("label-warning")})))}}};t.addEventListener("DOMContentLoaded",l.run,!1)})(Joomla,document);