!function(){"use strict";function e(e,t,i,n,s,a,r){try{var l=e[a](r),c=l.value}catch(e){return void i(e)}l.done?t(c):Promise.resolve(c).then(n,s)}function t(t){return function(){var i=this,n=arguments;return new Promise((function(s,a){var r=t.apply(i,n);function l(t){e(r,s,a,l,c,"next",t)}function c(t){e(r,s,a,l,c,"throw",t)}l(void 0)}))}}function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,t,i){return(r=a()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return i&&s(a,i.prototype),a}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return r(e,arguments,n(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),s(a,e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}!function(e,n){if(!n)throw new Error("Joomla API is not properly initiated");n.selectedMediaFile={},window.document.addEventListener("onMediaFileSelected",(function(e){n.selectedMediaFile=e.detail;var t=n.Modal.getCurrent(),i=t.querySelector(".modal-body"),s=i.querySelector("joomla-field-mediamore");s&&s.parentNode.removeChild(s),i.closest("joomla-field-media")||n.selectedMediaFile.path&&i.insertAdjacentHTML("afterbegin",'\n<joomla-field-mediamore\n  parent-id="'+t.id+'"\n  summary-label="'+n.Text._("JFIELD_MEDIA_SUMMARY_LABEL")+'"\n  lazy-label="'+n.Text._("JFIELD_MEDIA_LAZY_LABEL")+'"\n  alt-label="'+n.Text._("JFIELD_MEDIA_ALT_LABEL")+'"\n  alt-check-label="'+n.Text._("JFIELD_MEDIA_ALT_CHECK_LABEL")+'"\n  alt-check-desc-label="'+n.Text._("JFIELD_MEDIA_ALT_CHECK_DESC_LABEL")+'"\n  classes-label="'+n.Text._("JFIELD_MEDIA_CLASS_LABEL")+'"\n  figure-classes-label="'+n.Text._("JFIELD_MEDIA_FIGURE_CLASS_LABEL")+'"\n  figure-caption-label="'+n.Text._("JFIELD_MEDIA_FIGURE_CAPTION_LABEL")+'"\n></joomla-field-mediamore>\n')}));var a=function(e){return new Promise((function(t,i){var s=new Image;s.src=e,s.onload=function(){n.selectedMediaFile.width=s.width,n.selectedMediaFile.height=s.height,t(!0)},s.onerror=function(){i(!1)}}))},r=function(){var e=t(regeneratorRuntime.mark((function e(t,i,s){var r,l,c,o,u,d,p,h,f,g,m,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==t.success){e.next=49;break}if((r=t.data[0]).url?/local-/.test(r.adapter)?(l=n.getOptions("system.paths"),c=l.rootFull,n.selectedMediaFile.url=r.url.split(c)[1],r.thumb_path?n.selectedMediaFile.thumb=r.thumb_path:n.selectedMediaFile.thumb=!1):r.thumb_path&&(n.selectedMediaFile.url=r.url,n.selectedMediaFile.thumb=r.thumb_path):n.selectedMediaFile.url=!1,!n.selectedMediaFile.url){e.next=49;break}if(u="",d="",p="",h="",f="",g="",m="",v=i,"object"==typeof HTMLElement?v instanceof HTMLElement:v&&"object"==typeof v&&1===v.nodeType&&"string"==typeof v.nodeName){e.next=37;break}if(b=s.closest(".modal-content"),!(o=b.querySelector("joomla-field-mediamore"))){e.next=32;break}if("true"===o.getAttribute("alt-check")&&(p=' alt=""'),d=o.getAttribute("alt-value")?' alt="'+o.getAttribute("alt-value")+'"':p,h=o.getAttribute("img-classes")?' class="'+o.getAttribute("img-classes")+'"':"",f=o.getAttribute("fig-classes")?' class="'+o.getAttribute("fig-classes")+'"':"",g=o.getAttribute("fig-caption")?""+o.getAttribute("fig-caption"):"","true"!==o.getAttribute("is-lazy")){e.next=32;break}if(u=' loading="lazy" width="'+n.selectedMediaFile.width+'" height="'+n.selectedMediaFile.height+'"',0!==n.selectedMediaFile.width&&0!==n.selectedMediaFile.height){e.next=32;break}return e.prev=23,e.next=26,a(n.selectedMediaFile.url);case 26:u=' loading="lazy" width="'+n.selectedMediaFile.width+'" height="'+n.selectedMediaFile.height+'"',e.next=32;break;case 29:e.prev=29,e.t0=e.catch(23),u="";case 32:m=g?"<figure"+f+'><img src="'+n.selectedMediaFile.url+'"'+h+u+d+"/><figcaption>"+g+"</figcaption></figure>":'<img src="'+n.selectedMediaFile.url+'"'+h+u+d+"/>",o&&o.parentNode.removeChild(o),n.editors.instances[i].replaceSelection(m),e.next=49;break;case 37:if(0!==n.selectedMediaFile.width&&0!==n.selectedMediaFile.height){e.next=47;break}return e.prev=38,e.next=41,a(n.selectedMediaFile.url);case 41:e.next=47;break;case 43:e.prev=43,e.t1=e.catch(38),n.selectedMediaFile.height=0,n.selectedMediaFile.width=0;case 47:i.value=n.selectedMediaFile.url+"#joomlaImage://"+r.path.replace(":","")+"?width="+n.selectedMediaFile.width+"&height="+n.selectedMediaFile.height,s.updatePreview();case 49:case"end":return e.stop()}var v}),e,null,[[23,29],[38,43]])})));return function(t,i,n){return e.apply(this,arguments)}}();n.getImage=function(e,i,s){return new Promise((function(a,l){if(!e||"object"==typeof e&&(!e.path||""===e.path))return n.selectedMediaFile={},void a({resp:{success:!1}});var c,o=n.getOptions("system.paths").baseFull+"index.php?option=com_media";n.request({url:o+"&task=api.files&url=true&path="+e.path+"&"+n.getOptions("csrf.token")+"=1&format=json",method:"GET",perform:!0,headers:{"Content-Type":"application/json"},onSuccess:(c=t(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(t),e.t0=a,e.next=4,r(n,i,s);case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),onError:function(e){l(e)}})}))};var o=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).lazyInputFn=t.lazyInputFn.bind(c(t)),t.altInputFn=t.altInputFn.bind(c(t)),t.altCheckFn=t.altCheckFn.bind(c(t)),t.imgClassesFn=t.imgClassesFn.bind(c(t)),t.figclassesFn=t.figclassesFn.bind(c(t)),t.figcaptionFn=t.figcaptionFn.bind(c(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var r,l,o,u=a.prototype;return u.connectedCallback=function(){this.innerHTML="\n<details open>\n  <summary>"+this.summarytext+'</summary>\n  <div class="">\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-alt">'+this.alttext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-alt" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="form-check">\n        <input class="form-check-input" type="checkbox" id="'+this.parentId+'-alt-check">\n        <label class="form-check-label" for="'+this.parentId+'-alt-check">'+this.altchecktext+'</label>\n        <div><small class="form-text">'+this.altcheckdesctext+'</small></div>\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="form-check">\n        <input class="form-check-input" type="checkbox" id="'+this.parentId+'-lazy" checked>\n        <label class="form-check-label" for="'+this.parentId+'-lazy">'+this.lazytext+'</label>\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-classes">'+this.classestext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-classes" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-figclasses">'+this.figclassestext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-figclasses" />\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="input-group">\n        <label class="input-group-text" for="'+this.parentId+'-figcaption">'+this.figcaptiontext+'</label>\n        <input class="form-control" type="text" id="'+this.parentId+'-figcaption" />\n      </div>\n    </div>\n  </div>\n</details>',this.lazyInput=this.querySelector("#"+this.parentId+"-lazy"),this.lazyInput.addEventListener("change",this.lazyInputFn),this.altInput=this.querySelector("#"+this.parentId+"-alt"),this.altInput.addEventListener("input",this.altInputFn),this.altCheck=this.querySelector("#"+this.parentId+"-alt-check"),this.altCheck.addEventListener("input",this.altCheckFn),this.imgClasses=this.querySelector("#"+this.parentId+"-classes"),this.imgClasses.addEventListener("input",this.imgClassesFn),this.figClasses=this.querySelector("#"+this.parentId+"-figclasses"),this.figClasses.addEventListener("input",this.figclassesFn),this.figCaption=this.querySelector("#"+this.parentId+"-figcaption"),this.figCaption.addEventListener("input",this.figcaptionFn),this.setAttribute("is-lazy",!!this.lazyInput.checked),this.setAttribute("alt-value",""),this.setAttribute("alt-check",!1),this.setAttribute("img-classes",""),this.setAttribute("fig-classes",""),this.setAttribute("fig-caption","")},u.disconnectedCallback=function(){this.lazyInput.removeEventListener("input",this.lazyInputFn),this.altInput.removeEventListener("input",this.altInputFn),this.altCheck.removeEventListener("input",this.altCheckFn),this.imgClasses.removeEventListener("input",this.imgClassesFn),this.figClasses.removeEventListener("input",this.figclassesFn),this.figCaption.removeEventListener("input",this.figcaptionFn),this.innerHTML=""},u.lazyInputFn=function(e){this.setAttribute("is-lazy",!!e.target.checked)},u.altInputFn=function(e){this.setAttribute("alt-value",e.target.value.replace(/"/g,"&quot;"))},u.altCheckFn=function(e){this.setAttribute("alt-check",!!e.target.checked)},u.imgClassesFn=function(e){this.setAttribute("img-classes",e.target.value)},u.figclassesFn=function(e){this.setAttribute("fig-classes",e.target.value)},u.figcaptionFn=function(e){this.setAttribute("fig-caption",e.target.value)},r=a,(l=[{key:"parentId",get:function(){return this.getAttribute("parent-id")}},{key:"lazytext",get:function(){return this.getAttribute("lazy-label")}},{key:"alttext",get:function(){return this.getAttribute("alt-label")}},{key:"altchecktext",get:function(){return this.getAttribute("alt-check-label")}},{key:"altcheckdesctext",get:function(){return this.getAttribute("alt-check-desc-label")}},{key:"classestext",get:function(){return this.getAttribute("classes-label")}},{key:"figclassestext",get:function(){return this.getAttribute("figure-classes-label")}},{key:"figcaptiontext",get:function(){return this.getAttribute("figure-caption-label")}},{key:"summarytext",get:function(){return this.getAttribute("summary-label")}}])&&i(r.prototype,l),o&&i(r,o),a}(l(HTMLElement));e.define("joomla-field-mediamore",o)}(customElements,Joomla)}();