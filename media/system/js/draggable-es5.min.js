!function(){"use strict";var e,a,r,t,o,n=document.querySelector(".js-draggable"),l=n.querySelectorAll('[name="order[]"]');if(n)e=n.dataset.url,a=n.dataset.direction,r=n.dataset.nested;else if(Joomla.getOptions("draggable-list")){var d=Joomla.getOptions("draggable-list");(n=document.querySelector(d.id)).classList.contains("js-draggable")||n.classList.add("js-draggable"),e=d.url,a=d.direction,r=d.nested}if(n){for(var u=0,s=l.length;s>u;u+=1)l[u].dataset.order=u+1;document.addEventListener("touchstart",(function(){}),!1);var c=function(e,r,t,o){var n,l=[];if(t<o){for(e[o].setAttribute("value",e[o-1].value),n=t;n<o;n+=1)"asc"===a?e[n].setAttribute("value",parseInt(e[n].value,10)-1):e[n].setAttribute("value",parseInt(e[n].value,10)+1),l.push("order[]="+encodeURIComponent(e[n].value)),l.push("cid[]="+encodeURIComponent(r[n].value));l.push("order[]="+encodeURIComponent(e[o].value)),l.push("cid[]="+encodeURIComponent(r[o].value))}else for(e[o].setAttribute("value",e[o+1].value),e[o].value=e[o+1].value,l.push("order[]="+encodeURIComponent(e[o].value)),l.push("cid[]="+encodeURIComponent(r[o].value)),n=o+1;n<=t;n+=1)e[n].value="asc"===a?parseInt(e[n].value,10)+1:parseInt(e[n].value,10)-1,l.push("order[]="+encodeURIComponent(e[n].value)),l.push("cid[]="+encodeURIComponent(r[n].value));return l};dragula([n],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,t,o){return r&&null!==o?o.dataset.draggableGroup&&o.dataset.draggableGroup===e.dataset.draggableGroup:null===o||o&&"tr"===o.tagName.toLowerCase()},mirrorContainer:n}).on("drag",(function(e){t=parseInt(e.querySelector('[name="order[]"]').dataset.order,10)-1})).on("cloned",(function(){})).on("drop",(function(a){var r,l,d=a.dataset.draggableGroup;d?(r='[data-draggable-group="'+d+'"] [name="order[]"]',l='[data-draggable-group="'+d+'"] [name="cid[]"]'):(r='[name="order[]"]',l='[name="cid[]"]');for(var u=[].slice.call(n.querySelectorAll(r)),s=[].slice.call(n.querySelectorAll(l)),i=0,p=u.length-1;p>i;i+=1)if(u[i].dataset.order===a.querySelector('[name="order[]"]').dataset.order){o=i;break}if(e){var v=document.querySelector('[name="task"]');v&&v.setAttribute("name","some__Temporary__Name__");var g={url:e,method:"POST",data:c(u,s,t,o).join("&"),perform:!0};Joomla.request(g),v&&v.setAttribute("name","task")}})).on("dragend",(function(){for(var e=n.querySelectorAll('[name="order[]"]'),a=0,r=e.length;r>a;a+=1)e[a].dataset.order=a+1}))}}();