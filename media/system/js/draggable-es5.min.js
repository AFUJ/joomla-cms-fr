!function(){"use strict";var e,a,t,r,l,o=document.querySelector(".js-draggable");if(o)e=o.dataset.url,a=o.dataset.direction,t=o.dataset.nested;else if(Joomla.getOptions("draggable-list")){var n=Joomla.getOptions("draggable-list");(o=document.querySelector(n.id)).classList.contains("js-draggable")||o.classList.add("js-draggable"),e=n.url,a=n.direction,t=n.nested}if(o){document.addEventListener("touchstart",(function(){}),!1);var u=function(e,t,r,l){var o,n=[];if(r<l)for(e[l].setAttribute("value",e[l-1].value),o=r;o<l;o+=1)"asc"===a?e[o].setAttribute("value",parseInt(e[o].value,10)-1):e[o].setAttribute("value",parseInt(e[o].value,10)+1);else for(e[l].setAttribute("value",e[l+1].value),e[l].value=e[l+1].value,o=l+1;o<=r;o+=1)e[o].value="asc"===a?parseInt(e[o].value,10)+1:parseInt(e[o].value,10)-1;for(o=0;o<e.length-1;o+=1)n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(t[o].value));return n},d=function(a){var t,n,d,s=a.dataset.draggableGroup;s?(d='tr[data-draggable-group="'+s+'"]',t='[data-draggable-group="'+s+'"] [name="order[]"]',n='[data-draggable-group="'+s+'"] [name="cid[]"]'):(d="tr",t='[name="order[]"]',n='[name="cid[]"]');var i=[].slice.call(o.querySelectorAll(d)),c=[].slice.call(o.querySelectorAll(t)),g=[].slice.call(o.querySelectorAll(n));if(l=i.indexOf(a),e){var v=document.querySelector('[name="task"]');v&&v.setAttribute("name","some__Temporary__Name__");var p={url:e,method:"POST",data:u(c,g,r,l).join("&"),perform:!0};Joomla.request(p),v&&v.setAttribute("name","task")}!function(e){if(e.dataset.itemId){var a=e.dataset.itemId,t=o.querySelectorAll('tr[data-parents~="'+a+'"]');t.length&&e.after.apply(e,t)}}(a)};dragula([o],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,r,l){return t&&null!==l?l.dataset.draggableGroup&&l.dataset.draggableGroup===e.dataset.draggableGroup:null===l||l&&"tr"===l.tagName.toLowerCase()},mirrorContainer:o}).on("drag",(function(e){var a,t=e.dataset.draggableGroup;a=t?'tr[data-draggable-group="'+t+'"]':"tr";var l=[].slice.call(o.querySelectorAll(a));r=l.indexOf(e)})).on("drop",(function(e){d(e)}))}}();