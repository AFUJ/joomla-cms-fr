!function(){"use strict";var e,a,t,r,l,o,n,u=document.querySelector(".js-draggable");if(u)e=u.dataset.url,a=u.dataset.direction,t=u.dataset.nested;else if(Joomla.getOptions("draggable-list")){var d=Joomla.getOptions("draggable-list");(u=document.querySelector(d.id)).classList.contains("js-draggable")||u.classList.add("js-draggable"),e=d.url,a=d.direction,t=d.nested}if(u){o=u.closest("form"),(n=new FormData(o)).delete("task"),document.addEventListener("touchstart",(function(){}),!1);var s=function(e,t,r,l){var o,n=[];if(r<l)for(e[l].setAttribute("value",e[l-1].value),o=r;o<l;o+=1)"asc"===a?e[o].setAttribute("value",parseInt(e[o].value,10)-1):e[o].setAttribute("value",parseInt(e[o].value,10)+1);else for(e[l].setAttribute("value",e[l+1].value),e[l].value=e[l+1].value,o=l+1;o<=r;o+=1)e[o].value="asc"===a?parseInt(e[o].value,10)+1:parseInt(e[o].value,10)-1;for(o=0;o<e.length-1;o+=1)n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(t[o].value));return n},i=function(a){var t,o,d,i=a.dataset.draggableGroup;i?(d='tr[data-draggable-group="'+i+'"]',t='[data-draggable-group="'+i+'"] [name="order[]"]',o='[data-draggable-group="'+i+'"] [name="cid[]"]'):(d="tr",t='[name="order[]"]',o='[name="cid[]"]');var c=[].slice.call(u.querySelectorAll(d)),g=[].slice.call(u.querySelectorAll(t)),v=[].slice.call(u.querySelectorAll(o));if(l=c.indexOf(a),e){var m=document.querySelector('[name="task"]');m&&m.setAttribute("name","some__Temporary__Name__");var p={url:e,method:"POST",data:new URLSearchParams(n).toString()+"&"+s(g,v,r,l).join("&"),perform:!0};Joomla.request(p),m&&m.setAttribute("name","task")}!function(e){if(e.dataset.itemId){var a=e.dataset.itemId,t=u.querySelectorAll('tr[data-parents~="'+a+'"]');t.length&&e.after.apply(e,t)}}(a)};dragula([u],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,r,l){return t&&null!==l?l.dataset.draggableGroup&&l.dataset.draggableGroup===e.dataset.draggableGroup:null===l||l&&"tr"===l.tagName.toLowerCase()},mirrorContainer:u}).on("drag",(function(e){var a,t=e.dataset.draggableGroup;a=t?'tr[data-draggable-group="'+t+'"]':"tr";var l=[].slice.call(u.querySelectorAll(a));r=l.indexOf(e)})).on("drop",(function(e){i(e)}))}}();