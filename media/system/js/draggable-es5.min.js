!function(){"use strict";var e,a,t,r,l,o,n=document.querySelector(".js-draggable"),d=n.querySelectorAll('[name="order[]"]');if(n)e=n.dataset.url,a=n.dataset.direction,t=n.dataset.nested;else if(Joomla.getOptions("draggable-list")){var u=Joomla.getOptions("draggable-list");(n=document.querySelector(u.id)).classList.contains("js-draggable")||n.classList.add("js-draggable"),e=u.url,a=u.direction,t=u.nested}if(n){for(var s=0,i=d.length;i>s;s+=1)d[s].dataset.order=s+1;document.addEventListener("touchstart",(function(){}),!1);var c=function(e,t,r,l){var o,n=[];if(r<l)for(e[l].setAttribute("value",e[l-1].value),o=r;o<l;o+=1)"asc"===a?e[o].setAttribute("value",parseInt(e[o].value,10)-1):e[o].setAttribute("value",parseInt(e[o].value,10)+1);else for(e[l].setAttribute("value",e[l+1].value),e[l].value=e[l+1].value,o=l+1;o<=r;o+=1)e[o].value="asc"===a?parseInt(e[o].value,10)+1:parseInt(e[o].value,10)-1;for(o=0;o<e.length-1;o+=1)n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(t[o].value));return n},g=function(a){var t,o,d,u=a.dataset.draggableGroup;u?(d='tr[data-draggable-group="'+u+'"]',t='[data-draggable-group="'+u+'"] [name="order[]"]',o='[data-draggable-group="'+u+'"] [name="cid[]"]'):(d="tr",t='[name="order[]"]',o='[name="cid[]"]');var s=[].slice.call(n.querySelectorAll(d)),i=[].slice.call(n.querySelectorAll(t)),g=[].slice.call(n.querySelectorAll(o));if(l=s.indexOf(a),e){var v=document.querySelector('[name="task"]');v&&v.setAttribute("name","some__Temporary__Name__");var p={url:e,method:"POST",data:c(i,g,r,l).join("&"),perform:!0};Joomla.request(p),v&&v.setAttribute("name","task")}!function(e){if(e.dataset.itemId){var a=e.dataset.itemId,t=n.querySelectorAll('tr[data-parents~="'+a+'"]');t.length&&e.after.apply(e,t)}}(a);for(var m=n.querySelectorAll('[name="order[]"]'),f=0,b=m.length;b>f;f+=1)m[f].dataset.order=f+1};dragula([n],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,r,l){return t&&null!==l?l.dataset.draggableGroup&&l.dataset.draggableGroup===e.dataset.draggableGroup:null===l||l&&"tr"===l.tagName.toLowerCase()},mirrorContainer:n}).on("drag",(function(e){var a,t=e.dataset.draggableGroup;a=t?'tr[data-draggable-group="'+t+'"]':"tr";var l=[].slice.call(n.querySelectorAll(a));r=l.indexOf(e)})).on("drop",(function(e){o=e})).on("dragend",(function(){o&&(g(o),o=null)}))}}();