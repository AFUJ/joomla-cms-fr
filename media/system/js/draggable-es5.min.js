!function(){"use strict";var e,a,r,t,o,l=document.querySelector(".js-draggable"),n=l.querySelectorAll('[name="order[]"]');if(l)e=l.dataset.url,a=l.dataset.direction,r=l.dataset.nested;else if(Joomla.getOptions("draggable-list")){var d=Joomla.getOptions("draggable-list");(l=document.querySelector(d.id)).classList.contains("js-draggable")||l.classList.add("js-draggable"),e=d.url,a=d.direction,r=d.nested}if(l){for(var u=0,s=n.length;s>u;u+=1)n[u].dataset.order=u+1;document.addEventListener("touchstart",(function(){}),!1);var c=function(e,r,t,o){var l,n=[];if(t<o){for(e[o].setAttribute("value",e[o-1].value),l=t;l<o;l+=1)"asc"===a?e[l].setAttribute("value",parseInt(e[l].value,10)-1):e[l].setAttribute("value",parseInt(e[l].value,10)+1),n.push("order[]="+encodeURIComponent(e[l].value)),n.push("cid[]="+encodeURIComponent(r[l].value));n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(r[o].value))}else for(e[o].setAttribute("value",e[o+1].value),e[o].value=e[o+1].value,n.push("order[]="+encodeURIComponent(e[o].value)),n.push("cid[]="+encodeURIComponent(r[o].value)),l=o+1;l<=t;l+=1)e[l].value="asc"===a?parseInt(e[l].value,10)+1:parseInt(e[l].value,10)-1,n.push("order[]="+encodeURIComponent(e[l].value)),n.push("cid[]="+encodeURIComponent(r[l].value));return n};dragula([l],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,a,t,o){return r&&null!==o?o.dataset.draggableGroup&&o.dataset.draggableGroup===e.dataset.draggableGroup:null===o||o&&"tr"===o.tagName.toLowerCase()},mirrorContainer:l}).on("drag",(function(e){var a,r=e.dataset.draggableGroup;a=r?'tr[data-draggable-group="'+r+'"]':"tr";var o=[].slice.call(l.querySelectorAll(a));t=o.indexOf(e)})).on("cloned",(function(){})).on("drop",(function(a){var r,n,d,u=a.dataset.draggableGroup;u?(d='tr[data-draggable-group="'+u+'"]',r='[data-draggable-group="'+u+'"] [name="order[]"]',n='[data-draggable-group="'+u+'"] [name="cid[]"]'):(d="tr",r='[name="order[]"]',n='[name="cid[]"]');var s=[].slice.call(l.querySelectorAll(d)),i=[].slice.call(l.querySelectorAll(r)),g=[].slice.call(l.querySelectorAll(n));if(o=s.indexOf(a),e){var p=document.querySelector('[name="task"]');p&&p.setAttribute("name","some__Temporary__Name__");var v={url:e,method:"POST",data:c(i,g,t,o).join("&"),perform:!0};Joomla.request(v),p&&p.setAttribute("name","task")}})).on("dragend",(function(){for(var e=l.querySelectorAll('[name="order[]"]'),a=0,r=e.length;r>a;a+=1)e[a].dataset.order=a+1}))}}();