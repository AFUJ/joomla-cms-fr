!function(){"use strict";if(!Joomla)throw new Error("Joomla API is not properly initialised");!function(e,t,i){var n,r={view:"dashboard",id:0,ordering:"",version:"current",list:0,options:i.getOptions("plg_installer_webinstaller",{})},l=function(){function n(){}var l=n.prototype;return l.initialise=function(){var e=this;r.loaded=1,t.getElementById("uploadform-web-cancel").addEventListener("click",(function(){t.getElementById("uploadform-web").classList.add("hidden"),r.list&&t.querySelector(".list-view")&&t.querySelector(".list-view").click()})),t.getElementById("uploadform-web-install").addEventListener("click",(function(){4===r.options.installFrom?e.submitButtonUrl():e.submitButtonWeb()})),this.loadweb(r.options.base_url+"index.php?format=json&option=com_apps&view=dashboard"),this.clickforlinks()},l.loadweb=function(l){var a=this;if(!l)return!1;var o=new RegExp(r.options.base_url),s=new RegExp("^index.php");if(!o.test(l)&&!s.test(l))return e.open(l,"_blank"),!1;var d=l+"&product="+r.options.product+"&release="+r.options.release+"&dev_level="+r.options.dev_level+"&list="+(r.list?"list":"grid")+"&lang="+r.options.language,c=t.getElementById("com-apps-ordering"),u=t.getElementById("com-apps-filter-joomla-version");return""!==r.ordering&&c&&c.value&&(r.ordering=c.value,d+="&ordering="+r.ordering),""!==r.version&&u&&u.value&&(r.version=u.value,d+="&filter_version="+r.version),n.showLoadingLayer(),new Promise((function(e,l){i.request({url:d,onSuccess:function(l){var o;try{o=JSON.parse(l)}catch(e){throw new Error("Failed to parse JSON")}t.getElementById("web-loader")&&t.getElementById("web-loader").classList.add("hidden"),t.getElementById("jed-container").innerHTML=o.data.html,t.getElementById("com-apps-searchbox").addEventListener("keypress",(function(e){13===e.which&&a.initiateSearch()})),t.getElementById("search-extensions").addEventListener("click",(function(){a.initiateSearch()})),t.getElementById("search-reset").addEventListener("click",(function(){t.getElementById("com-apps-searchbox").value="",a.initiateSearch(),t.getElementById("search-reset").setAttribute("disabled","disabled")})),""===t.getElementById("com-apps-searchbox").value&&t.getElementById("search-reset").setAttribute("disabled","disabled"),t.getElementById("search-reset").innerHTML=i.JText._("JSEARCH_FILTER_CLEAR");var s=t.getElementById("com-apps-ordering"),d=t.getElementById("com-apps-filter-joomla-version");s&&s.addEventListener("change",(function(){var e=s.selectedIndex;r.ordering=s.options[e].value,a.installfromwebajaxsubmit()})),d&&d.addEventListener("change",(function(){var e=d.selectedIndex;r.version=d.options[e].value,a.installfromwebajaxsubmit()})),""!==r.options.installfrom_url&&n.installfromweb(r.options.installfrom_url),e()},onError:function(e){var n=t.getElementById("web-loader-error"),r=t.getElementById("web-loader");e.responseText&&n&&(n.innerHTML=e.responseText),r&&(r.classList.add("hidden"),n.classList.remove("hidden")),i.renderMessages({danger:[i.Text._("PLG_INSTALLER_WEBINSTALLER_INSTALL_WEB_LOADING_ERROR")]},"#web-loader-error"),l()}})})).finally((function(){var l=t.getElementById("joomlaapsinstallatinput");if(l&&(l.value=r.options.installat_url),a.clickforlinks(),n.clicker(),"extension"!==r.view&&[].slice.call(t.querySelectorAll("div.load-extension")).forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault(),a.processLinkClick(e.getAttribute("data-url"))})),e.setAttribute("href","#")})),"extension"===r.view){var o=t.getElementById("install-extension"),s=t.getElementById("install-extension-from-external");o&&o.addEventListener("click",(function(){n.installfromweb(o.getAttribute("data-downloadurl"),o.getAttribute("data-name")),t.getElementById("uploadform-web-install").scrollIntoView({behavior:"smooth",block:"start"})})),s&&s.addEventListener("click",(function(){var n=s.getAttribute("data-downloadurl");!0===e.confirm(i.Text._("PLG_INSTALLER_WEBINSTALLER_REDIRECT_TO_EXTERNAL_SITE_TO_INSTALL").replace("[SITEURL]",n))&&(t.getElementById("adminForm").setAttribute("action",n),t.querySelector("input[name=task]").setAttribute("disabled",!0),t.querySelector("input[name=install_directory]").setAttribute("disabled",!0),t.querySelector("input[name=install_url]").setAttribute("disabled",!0),t.querySelector("input[name=installtype]").setAttribute("disabled",!0),t.querySelector("input[name=filter_search]").setAttribute("disabled",!0),t.getElementById("adminForm").submit())}))}r.list&&t.querySelector(".list-view")&&t.querySelector(".list-view").click(),n.hideLoadingLayer()})),!0},l.clickforlinks=function(){var e=this;[].slice.call(t.querySelectorAll("a.transcode")).forEach((function(t){var i=t.getAttribute("href");t.addEventListener("click",(function(t){t.preventDefault(),e.processLinkClick(i)})),t.setAttribute("href","#")}))},l.initiateSearch=function(){t.getElementById("search-reset").removeAttribute("disabled"),r.view="dashboard",this.installfromwebajaxsubmit()},l.installfromwebajaxsubmit=function(){var e="&view="+r.view;(r.id&&(e+="&id="+r.id),t.getElementById("com-apps-searchbox").value)&&(e+="&filter_search="+encodeURI(t.getElementById("com-apps-searchbox").value.toLowerCase().replace(/ +/g,"_").replace(/[^a-z0-9-_]/g,"").trim()));var i=t.getElementById("com-apps-ordering"),n=t.getElementById("com-apps-filter-joomla-version");""!==r.ordering&&i&&i.value&&(r.ordering=i.value),r.ordering&&(e+="&ordering="+r.ordering),""!==r.version&&n&&n.value&&(r.version=n.value),r.version&&(e+="&filter_version="+r.version),this.loadweb(r.options.base_url+"index.php?format=json&option=com_apps"+e)},l.processLinkClick=function(e){var t=new RegExp(r.options.base_url),i=new RegExp("^index.php");t.test(e)||i.test(e)?(r.view=e.replace(/^.+[&?]view=(\w+).*$/,"$1"),"dashboard"===r.view?r.id=0:"category"===r.view&&(r.id=e.replace(/^.+[&?]id=(\d+).*$/,"$1")),this.loadweb(r.options.base_url+e)):this.loadweb(e)},n.showLoadingLayer=function(){t.getElementById("web").appendChild(t.createElement("joomla-core-loader"))},n.hideLoadingLayer=function(){var e=t.querySelector("#web joomla-core-loader");e.parentNode.removeChild(e)},n.clicker=function(){t.querySelector(".grid-view")&&t.querySelector(".grid-view").addEventListener("click",(function(){r.list=0,t.querySelector(".list-container").classList.add("hidden"),t.querySelector(".grid-container").classList.remove("hidden"),t.getElementById("btn-list-view").classList.remove("active"),t.getElementById("btn-grid-view").classList.remove("active")})),t.querySelector(".list-view")&&t.querySelector(".list-view").addEventListener("click",(function(){r.list=1,t.querySelector(".grid-container").classList.add("hidden"),t.querySelector(".list-container").classList.remove("hidden"),t.getElementById("btn-grid-view").classList.remove("active"),t.getElementById("btn-list-view").classList.add("active")}))},n.installfromweb=function(e,n){return void 0===n&&(n=null),e?(t.getElementById("install_url").value=e,t.getElementById("uploadform-web-url").innerText=e,n?(t.getElementById("uploadform-web-name").innerText=n,t.getElementById("uploadform-web-name-label").classList.remove("hidden")):t.getElementById("uploadform-web-name-label").classList.add("hidden"),t.getElementById("uploadform-web").classList.remove("hidden"),!0):(i.renderMessages({warning:[i.Text._("PLG_INSTALLER_WEBINSTALLER_CANNOT_INSTALL_EXTENSION_IN_PLUGIN")]}),!1)},l.submitButtonUrl=function(){var e=t.getElementById("adminForm");if(""===e.install_url.value||"http://"===e.install_url.value||"https://"===e.install_url.value)i.renderMessages({warning:[i.Text._("COM_INSTALLER_MSG_INSTALL_ENTER_A_URL")]});else{var n=t.getElementById("loading");n&&n.classList.remove("hidden"),e.installtype.value="url",e.submit()}},l.submitButtonWeb=function(){var e=t.getElementById("adminForm");""!==e.install_url.value||"http://"!==e.install_url.value||"https://"!==e.install_url.value?this.submitButtonUrl():""===e.install_url.value?i.renderMessages({warning:[i.apps.options.btntxt]}):(t.querySelector("#appsloading").classList.remove("hidden"),e.installtype.value="web",e.submit())},n}();t.addEventListener("DOMContentLoaded",(function(){e.setTimeout((function i(){var a=t.getElementById("myTab");if("UL"===a.firstElementChild.tagName){var o=a.querySelector("#tab-web");o&&(r.options.installfromon&&o.click(),o.hasAttribute("active")&&!n&&(n=new l).initialise(),""!==r.options.installfrom_url&&o.click(),o.addEventListener("joomla.tab.shown",(function(){n||(n=new l).initialise()})))}else e.setTimeout(i,50)}),50)}))}(window,document,Joomla)}();